import{d as I,s as z,as as L,o as t,l as x,w as n,b as a,c as l,F as b,k,e as p,a as i,aI as B,a8 as y,q as w,br as T,K as J,a6 as O,ac as R,E as D}from"./index-db0350d3.js";import{E as K,a as M}from"./el-table-column-c9108ba7.js";import"./el-checkbox-79eb5818.js";import"./el-tooltip-4ed993c7.js";import{E as W}from"./el-popper-50991514.js";import"./el-tag-9785a90b.js";const A={fc:""},G={key:0,class:"absolute h-full w-full fc bg-black/40"},H=["src"],P=["src"],Q={class:"w-44 fc flex-wrap"},U=["src"],X={class:"w-44 fc flex-wrap"},Y=["src"],Z={class:"waterfall"},ee={class:"relative fc flex-col select-none"},te={key:0,class:"absolute h-full w-full bg-black/40"},se=["src"],ae={class:"fc"},le={key:0,class:"absolute z-10 h-full w-full bg-black/80"},ne=["onClick"],ce={key:0,class:"absolute h-full w-full fc bg-black/40"},oe={class:"fc flex-col select-none"},ie=["src"],he=I({__name:"ViewResult",props:["selectedBullet"],emits:["change","update:selectedBullet"],setup(S,{emit:j}){const N=S,E=z({get:()=>N.selectedBullet,set:e=>{j("update:selectedBullet",e)}}),V=z(()=>{const e=[];return E.value.forEach(_=>{var r;if((r=_.at(-1))!=null&&r.total){const d=_.at(-1).total;d==null||d.forEach(c=>{const f=e.find(h=>h.item_id===c.item_id);f?f.number+=c.number:e.push(JSON.parse(JSON.stringify(c)))})}}),e}),{height:$}=L();function q(e,_,r,d){if(r.kind!=="54"&&(r.done=!r.done),!_.article.find(c=>!c.done)){_.done=!0,d<e.length-1&&e.splice(d,1);let c=d;for(;c<e.length;){const f=e[c].article.find(h=>h.item_id===_.seq_id&&h.number===_.number);if(f){f.done=!0;break}c++}}}function m(e){if(!e)return"https://prd-game-a1-granbluefantasy.akamaized.net/assets/img/sp/job/bullet/empty.png";if(e.article)return`https://prd-game-a-granbluefantasy.akamaized.net/assets/img/sp/assets/bullet/s/${e.seq_id}.jpg`;if(e.kind==="10")return`https://prd-game-a-granbluefantasy.akamaized.net/assets/img/sp/assets/item/article/s/${e.item_id}.jpg`;if(e.kind==="17")return`https://prd-game-a-granbluefantasy.akamaized.net/assets/img/sp/assets/item/evolution/s/${e.item_id}.jpg`;if(e.kind==="54")return`https://prd-game-a-granbluefantasy.akamaized.net/assets/img/sp/assets/bullet/s/${e.item_id}.jpg`}return(e,_)=>{const r=O,d=W,c=K,f=M,h=R,F=D;return t(),x(F,null,{header:n(()=>[a("div",A,[(t(!0),l(b,null,k(p(E),(s,g)=>{var o;return t(),l("div",{key:g,relative:"",fc:""},[s.at(-1)&&((o=s.at(-1))!=null&&o.done)?(t(),l("div",G,[i(r,{size:45,color:"#409EFC"},{default:n(()=>[i(p(B))]),_:1})])):y("",!0),s.length===0?(t(),l("img",{key:1,class:"m-2 h-14 w-14",src:m(s.at(-1))},null,8,H)):(t(),x(d,{key:2,effect:"dark",placement:"bottom"},{content:n(()=>{var v;return[a("div",Q,[(t(!0),l(b,null,k((v=s.at(-1))==null?void 0:v.total,(u,C)=>(t(),l("div",{key:C,class:"fc flex-col select-none"},[a("img",{class:"m-1 h-12 w-12",src:m(u)},null,8,U),a("span",null,w(u.number),1)]))),128))])]}),default:n(()=>[a("img",{class:"m-2 h-14 w-14",src:m(s.at(-1))},null,8,P)]),_:2},1024))])}),128)),i(d,{effect:"dark",placement:"bottom"},{content:n(()=>[a("div",X,[(t(!0),l(b,null,k(p(V),(s,g)=>(t(),l("div",{key:g,class:"fc flex-col select-none"},[a("img",{class:"m-1 h-12 w-12",src:m(s)},null,8,Y),a("span",null,w(s.number),1)]))),128))])]),default:n(()=>[i(r,{"ml-2":"","mt-9":""},{default:n(()=>[i(p(T))]),_:1})]),_:1})])]),default:n(()=>[i(h,{height:p($)-315},{default:n(()=>[a("div",Z,[(t(!0),l(b,null,k(p(E).filter(s=>s.length!==0&&s[s.length-1].done!==!0),(s,g)=>(t(),l("div",{key:g,class:"water m-auto p-2"},[i(f,{data:s},{default:n(()=>[i(c,{prop:"seq_id",label:"目标",width:"80",align:"center"},{default:n(({row:o})=>[a("div",ee,[o.done?(t(),l("div",te)):y("",!0),a("img",{class:"m-1 h-12 w-12",src:m(o)},null,8,se),a("span",null,w(o.number?o.number:"1"),1)])]),_:1}),i(c,{prop:"article",label:"材料",width:"260",align:"center"},{default:n(({row:o,$index:v})=>[a("div",ae,[o.article.find(u=>u.kind==="54"&&u.done!==!0)?(t(),l("div",le)):y("",!0),(t(!0),l(b,null,k(o.article,(u,C)=>(t(),l("div",{key:C,class:"relative cursor-pointer",onClick:J(re=>q(s,o,u,v),["prevent"])},[u.done?(t(),l("div",ce,[i(r,{size:45,color:"#409EFC"},{default:n(()=>[i(p(B))]),_:1})])):y("",!0),a("div",oe,[a("img",{class:"m-1 h-12 w-12",src:m(u)},null,8,ie),a("span",null,w(u.number),1)])],8,ne))),128))])]),_:2},1024)]),_:2},1032,["data"])]))),128))])]),_:1},8,["height"])]),_:1})}}});export{he as _};
