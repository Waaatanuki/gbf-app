import{_ as O,E as ne,e as pe,a as se,q as fe}from"./base-d162ef96.js";import{d as me,a as ye,E as he,u as ve}from"./el-overlay-375e2e02.js";import{E as ge}from"./el-progress-fce0f48f.js";import{a as Q,E as oe}from"./el-popper-4c0fcaf7.js";import{b as x,E as W}from"./el-button-a3f7639e.js";import{E as be}from"./el-card-c6491a2c.js";import"./el-tooltip-4ed993c7.js";import{a as _e}from"./file-01077a93.js";import{d as K}from"./dayjs.min-34a2093e.js";import{l as we}from"./lodash-f3bfa25a.js";import{_ as Ce}from"./Drawer.vue_vue_type_script_setup_true_lang-5d3d266e.js";import{d as Se}from"./file-fcde9183.js";import{a as ke}from"./index-b7a986ea.js";import{E as N}from"./el-message-89a1a08b.js";import{b as V,e as P,f as I,r as X,u as U,P as ae,M as j,g as i,m as E,v as c,p as u,D as Ee,j as p,R as re,y as Be,n as g,h as _,G as R,t as k,s as $,E as Fe,ab as $e,ac as Te,C as G,k as a,x as le,q as ie,X as w,d as ee,ad as De,c as Ie,ae as Re,Y as ze,Z as Pe,o as Ae,T as q,W as Je,F as Le,af as Me}from"./index-e1e4d07d.js";import{i as Ne}from"./icon-4d217982.js";import{E as je}from"./focus-trap-9c06f385.js";import{u as te}from"./index-927a9af8.js";import{a as qe}from"./use-form-item-77ae3ce7.js";import{_ as Oe}from"./_plugin-vue_export-helper-c27b6911.js";import"./vnode-1be7d77b.js";import"./event-9519ab40.js";import"./constants-4db3609e.js";import"./scroll-49bb2d6e.js";import"./typescript-defaf979.js";import"./_baseClone-2e5d4ca7.js";import"./_Uint8Array-6184b0e9.js";import"./_initCloneObject-b176e66b.js";import"./isEqual-9aa6cdf6.js";import"./index-5725fa7a.js";import"./aria-60e0cdc6.js";import"./index-f8748455.js";import"./el-input-4552dc9d.js";import"./el-tag-51a09018.js";import"./el-select-9d5401d4.js";import"./el-scrollbar-528d0670.js";import"./strings-d9adb3a2.js";import"./validator-a8260ea7.js";import"./BarChart.vue_vue_type_script_setup_true_lang-7caf26d5.js";import"./DetailTable.vue_vue_type_script_setup_true_lang-d8d69710.js";import"./el-table-column-c6742379.js";import"./el-checkbox-7957f217.js";import"./flatten-e9b73458.js";const Ve=V({...me,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0}}),Ue=ye,Ge=P({name:"ElDrawer",components:{ElOverlay:he,ElFocusTrap:je,ElIcon:ne,Close:pe},inheritAttrs:!1,props:Ve,emits:Ue,setup(e,{slots:t}){te({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},I(()=>!!t.title)),te({scope:"el-drawer",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/drawer.html#attributes",type:"Attribute"},I(()=>!!e.customClass));const n=X(),s=X(),f=U("drawer"),{t:o}=ae(),v=I(()=>e.direction==="rtl"||e.direction==="ltr"),S=I(()=>se(e.size));return{...ve(e,n),drawerRef:n,focusStartRef:s,isHorizontal:v,drawerSize:S,ns:f,t:o}}}),Ke=["aria-label","aria-labelledby","aria-describedby"],Ye=["id"],He=["aria-label"],We=["id"];function Xe(e,t,n,s,f,o){const v=j("close"),S=j("el-icon"),A=j("el-focus-trap"),J=j("el-overlay");return i(),E(Te,{to:"body",disabled:!e.appendToBody},[c($e,{name:e.ns.b("fade"),onAfterEnter:e.afterEnter,onAfterLeave:e.afterLeave,onBeforeLeave:e.beforeLeave,persisted:""},{default:u(()=>[Ee(c(J,{mask:e.modal,"overlay-class":e.modalClass,"z-index":e.zIndex,onClick:e.onModalClick},{default:u(()=>[c(A,{loop:"",trapped:e.visible,"focus-trap-el":e.drawerRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:u(()=>[p("div",re({ref:"drawerRef","aria-modal":"true","aria-label":e.title||void 0,"aria-labelledby":e.title?void 0:e.titleId,"aria-describedby":e.bodyId},e.$attrs,{class:[e.ns.b(),e.direction,e.visible&&"open",e.customClass],style:e.isHorizontal?"width: "+e.drawerSize:"height: "+e.drawerSize,role:"dialog",onClick:t[1]||(t[1]=Be(()=>{},["stop"]))}),[p("span",{ref:"focusStartRef",class:g(e.ns.e("sr-focus")),tabindex:"-1"},null,2),e.withHeader?(i(),_("header",{key:0,class:g(e.ns.e("header"))},[e.$slots.title?R(e.$slots,"title",{key:1},()=>[$(" DEPRECATED SLOT ")]):R(e.$slots,"header",{key:0,close:e.handleClose,titleId:e.titleId,titleClass:e.ns.e("title")},()=>[e.$slots.title?$("v-if",!0):(i(),_("span",{key:0,id:e.titleId,role:"heading",class:g(e.ns.e("title"))},k(e.title),11,Ye))]),e.showClose?(i(),_("button",{key:2,"aria-label":e.t("el.drawer.close"),class:g(e.ns.e("close-btn")),type:"button",onClick:t[0]||(t[0]=(...D)=>e.handleClose&&e.handleClose(...D))},[c(S,{class:g(e.ns.e("close"))},{default:u(()=>[c(v)]),_:1},8,["class"])],10,He)):$("v-if",!0)],2)):$("v-if",!0),e.rendered?(i(),_("div",{key:1,id:e.bodyId,class:g(e.ns.e("body"))},[R(e.$slots,"default")],10,We)):$("v-if",!0),e.$slots.footer?(i(),_("div",{key:2,class:g(e.ns.e("footer"))},[R(e.$slots,"footer")],2)):$("v-if",!0)],16,Ke)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[Fe,e.visible]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"])}var Ze=O(Ge,[["render",Xe],["__file","/home/runner/work/element-plus/element-plus/packages/components/drawer/src/drawer.vue"]]);const Qe=G(Ze),xe=V({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:x,default:"primary"},cancelButtonType:{type:String,values:x,default:"text"},icon:{type:Ne,default:()=>fe},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:Q.teleported,persistent:Q.persistent,width:{type:[String,Number],default:150}}),et={confirm:e=>e instanceof MouseEvent,cancel:e=>e instanceof MouseEvent},tt=P({name:"ElPopconfirm"}),nt=P({...tt,props:xe,emits:et,setup(e,{emit:t}){const n=e,{t:s}=ae(),f=U("popconfirm"),o=X(),v=()=>{var l,y;(y=(l=o.value)==null?void 0:l.onClose)==null||y.call(l)},S=I(()=>({width:se(n.width)})),A=l=>{t("confirm",l),v()},J=l=>{t("cancel",l),v()},D=I(()=>n.confirmButtonText||s("el.popconfirm.confirmButtonText")),z=I(()=>n.cancelButtonText||s("el.popconfirm.cancelButtonText"));return(l,y)=>(i(),E(a(oe),re({ref_key:"tooltipRef",ref:o,trigger:"click",effect:"light"},l.$attrs,{"popper-class":`${a(f).namespace.value}-popover`,"popper-style":a(S),teleported:l.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":l.hideAfter,persistent:l.persistent}),{content:u(()=>[p("div",{class:g(a(f).b())},[p("div",{class:g(a(f).e("main"))},[!l.hideIcon&&l.icon?(i(),E(a(ne),{key:0,class:g(a(f).e("icon")),style:le({color:l.iconColor})},{default:u(()=>[(i(),E(ie(l.icon)))]),_:1},8,["class","style"])):$("v-if",!0),w(" "+k(l.title),1)],2),p("div",{class:g(a(f).e("action"))},[c(a(W),{size:"small",type:l.cancelButtonType==="text"?"":l.cancelButtonType,text:l.cancelButtonType==="text",onClick:J},{default:u(()=>[w(k(a(z)),1)]),_:1},8,["type","text"]),c(a(W),{size:"small",type:l.confirmButtonType==="text"?"":l.confirmButtonType,text:l.confirmButtonType==="text",onClick:A},{default:u(()=>[w(k(a(D)),1)]),_:1},8,["type","text"])],2)],2)]),default:u(()=>[l.$slots.reference?R(l.$slots,"reference",{key:0}):$("v-if",!0)]),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}});var st=O(nt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popconfirm/src/popconfirm.vue"]]);const ot=G(st),at=V({decimalSeparator:{type:String,default:"."},groupSeparator:{type:String,default:","},precision:{type:Number,default:0},formatter:Function,value:{type:ee([Number,Object]),default:0},prefix:String,suffix:String,title:String,valueStyle:{type:ee([String,Object,Array])}}),rt=P({name:"ElStatistic"}),lt=P({...rt,props:at,setup(e,{expose:t}){const n=e,s=U("statistic"),f=I(()=>{const{value:o,formatter:v,precision:S,decimalSeparator:A,groupSeparator:J}=n;if(De(v))return v(o);if(!Ie(o))return o;let[D,z=""]=String(o).split(".");return z=z.padEnd(S,"0").slice(0,S>0?S:0),D=D.replace(/\B(?=(\d{3})+(?!\d))/g,J),[D,z].join(z?A:"")});return t({displayValue:f}),(o,v)=>(i(),_("div",{class:g(a(s).b())},[o.$slots.title||o.title?(i(),_("div",{key:0,class:g(a(s).e("head"))},[R(o.$slots,"title",{},()=>[w(k(o.title),1)])],2)):$("v-if",!0),p("div",{class:g(a(s).e("content"))},[o.$slots.prefix||o.prefix?(i(),_("div",{key:0,class:g(a(s).e("prefix"))},[R(o.$slots,"prefix",{},()=>[p("span",null,k(o.prefix),1)])],2)):$("v-if",!0),p("span",{class:g(a(s).e("number")),style:le(o.valueStyle)},k(a(f)),7),o.$slots.suffix||o.suffix?(i(),_("div",{key:1,class:g(a(s).e("suffix"))},[R(o.$slots,"suffix",{},()=>[p("span",null,k(o.suffix),1)])],2)):$("v-if",!0)],2)],2))}});var it=O(lt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/statistic/src/statistic.vue"]]);const ut=G(it),dt=V({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:Re,default:""},truncated:{type:Boolean},tag:{type:String,default:"span"}}),ct=P({name:"ElText"}),pt=P({...ct,props:dt,setup(e){const t=e,n=qe(),s=U("text"),f=I(()=>[s.b(),s.m(t.type),s.m(n.value),s.is("truncated",t.truncated)]);return(o,v)=>(i(),E(ie(o.tag),{class:g(a(f))},{default:u(()=>[R(o.$slots,"default")]),_:3},8,["class"]))}});var ft=O(pt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/text/src/text.vue"]]);const mt=G(ft);function C(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function ue(e,t){const n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);const s=C(n);return(f,o)=>s.then(v=>o(v.transaction(t,f).objectStore(t)))}let Y;function T(){return Y||(Y=ue("keyval-store","keyval")),Y}function yt(e,t=T()){return t("readonly",n=>C(n.get(e)))}function ht(e,t,n=T()){return n("readwrite",s=>(s.put(t,e),C(s.transaction)))}function vt(e,t=T()){return t("readwrite",n=>(e.forEach(s=>n.put(s[1],s[0])),C(n.transaction)))}function gt(e,t=T()){return t("readonly",n=>Promise.all(e.map(s=>C(n.get(s)))))}function bt(e,t,n=T()){return n("readwrite",s=>new Promise((f,o)=>{s.get(e).onsuccess=function(){try{s.put(t(this.result),e),f(C(s.transaction))}catch(v){o(v)}}}))}function _t(e,t=T()){return t("readwrite",n=>(n.delete(e),C(n.transaction)))}function wt(e,t=T()){return t("readwrite",n=>(e.forEach(s=>n.delete(s)),C(n.transaction)))}function Ct(e=T()){return e("readwrite",t=>(t.clear(),C(t.transaction)))}function Z(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},C(e.transaction)}function St(e=T()){return e("readonly",t=>{if(t.getAllKeys)return C(t.getAllKeys());const n=[];return Z(t,s=>n.push(s.key)).then(()=>n)})}function kt(e=T()){return e("readonly",t=>{if(t.getAll)return C(t.getAll());const n=[];return Z(t,s=>n.push(s.value)).then(()=>n)})}function Et(e=T()){return e("readonly",t=>{if(t.getAll&&t.getAllKeys)return Promise.all([C(t.getAllKeys()),C(t.getAll())]).then(([s,f])=>s.map((o,v)=>[o,f[v]]));const n=[];return e("readonly",s=>Z(s,f=>n.push([f.key,f.value])).then(()=>n))})}const F=ue("gbfApp","GoldBrick"),H={get(e){return yt(e,F)},getMany(e){return gt(e,F)},set(e,t){return ht(e,t,F)},setMany(e){return vt(e,F)},update(e,t){return bt(e,t,F)},del(e){return _t(e,F)},delMany(e){return wt(e,F)},clear(){return Ct(F)},entries(){return Et(F)},keys(){return St(F)},values(){return kt(F)}},Bt={class:"app-container"},Ft={flex:"","gap-5":""},$t={"w-180px":"",fc:"","shrink-0":""},Tt=["src"],Dt={"w-full":"",fc:"","flex-col":"","gap-4":""},It={flex:"","justify-evenly":"","gap-10":"","flex-wrap":""},Rt={"w-100px":""},zt={"w-120px":""},Pt={"w-100px":""},At={key:1,"w-100px":""},Jt={"w-100px":""},Lt={"w-100px":""},Mt={"w-100px":""},Nt={"w-100px":""},jt={class:"uploader"},qt=P({__name:"index",setup(e){const t=ze({dataSet:[],filesList:[],uploadBtnLoading:!1,baseInfo:[],drawer:{title:"",visible:!1,key:"",dataSet:[],tableData:[]}}),{filesList:n,baseInfo:s,uploadBtnLoading:f,drawer:o}=Pe(t);function v(y){if(y.raidName==="cb")return N.warning("超巴没有详细图表");t.drawer.visible=!0,t.drawer.title=`${y.quest_name_jp} 详细图表`,t.drawer.key=y.quest_id,t.drawer.dataSet=t.dataSet.filter(m=>{const b=Object.values(m)[0];return y.raidName===b.raidName}),t.drawer.tableData=t.baseInfo.find(m=>y.quest_id===m.quest_id).monthlyTableData}async function S(){t.dataSet=[],(await H.entries()).forEach(m=>{t.dataSet.push({[m[0]]:m[1]})}),t.baseInfo=A(t.dataSet)}function A(y){const m=we.cloneDeep(ke);return y.forEach(b=>{const d=Object.values(b)[0],h=m.find(M=>M.raidName===d.raidName);if(!h)return;const L=K(d.timestamp).format("YYYY-MM");let B=h.monthlyTableData.find(M=>M.date===L);B||(B={date:L,total:0,blueChest:0,blueChestFFJ:0,ring3:0},h.monthlyTableData.unshift(B)),h.total++,B.total++,d.goldBrick&&(d.goldBrick==="3"&&h.normalChestFFJ++,d.goldBrick==="4"&&h.redChestFFJ++,d.goldBrick==="11"&&h.blueChestFFJ++,d.goldBrick==="11"&&B.blueChestFFJ++,h.lastFFJTime=d.timestamp),d.blueChests&&(h.blueChest++,h.lastBlueChestCount++,B.blueChest++,d.blueChests==="73_1"&&h.ring1++,d.blueChests==="73_2"&&h.ring2++,d.blueChests==="73_3"&&h.ring3++,d.blueChests==="73_3"&&B.ring3++,d.blueChests==="17_20004"&&(h.lastBlueChestCount=0))}),m}function J(y){const m=y.raw;if(m.type!=="application/json")return N.error("文件格式不对");const b=new FileReader;b.readAsText(m),b.onload=function(){t.uploadBtnLoading=!0,t.dataSet=JSON.parse(b.result);const d=[];t.dataSet.forEach(h=>{const L=Object.keys(h)[0];d.push([L,Me(h[L])])}),H.setMany(d).then(()=>{N.success("上传成功"),S()}).finally(()=>{t.uploadBtnLoading=!1})}}function D(){if(t.dataSet.length===0)return N.info("没有数据可以导出");const m=`金本数据 ${new Date().toLocaleDateString()}`;Se(JSON.stringify(t.dataSet),m)}async function z(){await H.clear(),S()}function l(y=0,m=0){return m===0?0:(y/m*100).toFixed(2)}return Ae(()=>{S()}),(y,m)=>{const b=ut,d=mt,h=oe,L=be,B=W,M=ot,de=ge,ce=Qe;return i(),_("div",Bt,[(i(!0),_(q,null,Je(a(s),r=>(i(),E(L,{key:r.quest_id,"cursor-pointer":"","mb-2":"",shadow:"hover",onClick:Ot=>v(r)},{default:u(()=>[p("div",Ft,[p("div",$t,[p("img",{"w-full":"",src:("getImageSrc"in y?y.getImageSrc:a(_e))(r.quest_id,"raid/img-quest-thumb")},null,8,Tt)]),p("div",Dt,[p("div",It,[p("div",Rt,[c(b,{value:r.total,title:"总次数"},null,8,["value"])]),r.is_blue_treasure?(i(),_(q,{key:0},[p("div",zt,[c(b,{value:r.blueChest,title:"蓝箱"},null,8,["value"]),p("div",null,[c(d,{size:"small"},{default:u(()=>[w(" 蓝箱率： "+k(l(r.blueChest,r.total))+"% ",1)]),_:2},1024)])]),r.quest_id==="301061"?(i(),E(h,{key:0,content:"蓝箱金+自发金"},{default:u(()=>[p("div",Pt,[c(b,{value:r.blueChestFFJ,title:"菲菲金",suffix:`+ ${r.redChestFFJ}`},null,8,["value","suffix"]),p("div",null,[c(d,{size:"small"},{default:u(()=>[w(" 蓝箱金率： "+k(l(r.blueChestFFJ,r.blueChest))+"% ",1)]),_:2},1024)])])]),_:2},1024)):(i(),_("div",At,[c(b,{value:r.blueChestFFJ,title:"菲菲金"},null,8,["value"]),p("div",null,[c(d,{size:"small"},{default:u(()=>[w(" 蓝箱金率： "+k(l(r.blueChestFFJ,r.blueChest))+"% ",1)]),_:2},1024)])])),p("div",Jt,[c(b,{value:r.ring3,title:"红戒指"},null,8,["value"])]),p("div",Lt,[c(b,{value:r.ring2,title:"黑戒指"},null,8,["value"])]),p("div",Mt,[c(b,{value:r.ring1,title:"白戒指"},null,8,["value"])])],64)):(i(),E(h,{key:1,content:"自发金+金箱金"},{default:u(()=>[p("div",Nt,[c(b,{value:r.redChestFFJ,title:"菲菲金",suffix:`+ ${r.normalChestFFJ}`},null,8,["value","suffix"])])]),_:2},1024))]),r.is_blue_treasure?(i(),_(q,{key:0},[r.blueChestFFJ===0?(i(),E(d,{key:0,type:"warning"},{default:u(()=>[w(" 还未出过金 ")]),_:1})):(i(),E(d,{key:1,type:"info"},{default:u(()=>[w(" 距离上次出金已经打了"+k(r.lastBlueChestCount)+"个蓝箱 ",1)]),_:2},1024))],64)):(i(),_(q,{key:1},[r.redChestFFJ===0?(i(),E(d,{key:0,type:"warning"},{default:u(()=>[w(" 还未出过金 ")]),_:1})):(i(),E(d,{key:1,type:"info"},{default:u(()=>[w(" 距离上次出金已经过去了"+k(a(K)().diff(a(K)(r.lastFFJTime),"day"))+"天 ",1)]),_:2},1024))],64))])])]),_:2},1032,["onClick"]))),128)),p("div",jt,[c(M,{title:"清空操作无法恢复，确认清空吗?",width:"300",onConfirm:z},{reference:u(()=>[c(B,{type:"danger"},{default:u(()=>[w(" 清空数据 ")]),_:1})]),_:1}),c(B,{type:"info",onClick:D},{default:u(()=>[w(" 导出 ")]),_:1}),c(de,{"file-list":a(n),"onUpdate:fileList":m[1]||(m[1]=r=>Le(n)?n.value=r:null),"on-change":J,"show-file-list":!1,limit:1,"auto-upload":!1,accept:".json"},{trigger:u(()=>[c(B,{type:"primary",loading:a(f),onClick:m[0]||(m[0]=r=>n.value=[])},{default:u(()=>[w(" 上传 ")]),_:1},8,["loading"])]),_:1},8,["file-list"])]),c(ce,{modelValue:a(o).visible,"onUpdate:modelValue":m[2]||(m[2]=r=>a(o).visible=r),title:a(o).title,size:600,"destroy-on-close":""},{default:u(()=>[c(Ce,{id:a(o).key,data:a(o).dataSet,"table-data":a(o).tableData},null,8,["id","data","table-data"])]),_:1},8,["modelValue","title"])])}}});const zn=Oe(qt,[["__scopeId","data-v-52c64abe"]]);export{zn as default};
