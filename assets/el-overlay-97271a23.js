import{a4 as Z,u as D,bf as q,z as B,aS as G,aI as h,b as k,g as O,d as K,O as J,e as E,B as Q,ah as X,b2 as R,r as v,bg as ee,x as M,I as oe,o as te,l as ne,bh as le}from"./index-0edfd5ee.js";import{P as x}from"./vnode-3910aac9.js";import{t as se,D as F,h as I,y as ae,a as ue,r as ce,i as ie,j as P,g as de,u as T}from"./base-c9dcbedb.js";import{U as z}from"./use-form-item-aee03b26.js";import{g as re}from"./scroll-4f045813.js";const fe=(e,o={})=>{Z(e)||se("[useLockscreen]","You need to pass a ref param to this function");const u=o.ns||D("popup"),t=q(()=>u.bm("parent","hidden"));if(!F||I(document.body,t.value))return;let c=0,a=!1,n="0";const d=()=>{setTimeout(()=>{ce(document==null?void 0:document.body,t.value),a&&document&&(document.body.style.width=n)},200)};B(e,s=>{if(!s){d();return}a=!I(document.body,t.value),a&&(n=document.body.style.width),c=re(u.namespace.value);const f=document.documentElement.clientHeight<document.body.scrollHeight,r=ae(document.body,"overflowY");c>0&&(f||r==="scroll")&&a&&(document.body.style.width=`calc(100% - ${c}px)`),ue(document.body,t.value)}),G(()=>d())},ye=e=>{if(!e)return{onClick:h,onMousedown:h,onMouseup:h};let o=!1,u=!1;return{onClick:n=>{o&&u&&e(n),o=u=!1},onMousedown:n=>{o=n.target===n.currentTarget},onMouseup:n=>{u=n.target===n.currentTarget}}},me=k({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:O([String,Array,Object])},zIndex:{type:O([String,Number])}}),ve={click:e=>e instanceof MouseEvent},pe="overlay";var Ce=K({name:"ElOverlay",props:me,emits:ve,setup(e,{slots:o,emit:u}){const t=D(pe),c=s=>{u("click",s)},{onClick:a,onMousedown:n,onMouseup:d}=ye(e.customMaskEvent?void 0:c);return()=>e.mask?J("div",{class:[t.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:a,onMousedown:n,onMouseup:d},[E(o,"default")],x.STYLE|x.CLASS|x.PROPS,["onClick","onMouseup","onMousedown"]):Q("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[E(o,"default")])}});const ke=Ce,be=k({center:Boolean,alignCenter:Boolean,closeIcon:{type:ie},customClass:{type:String,default:""},draggable:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""}}),we={close:()=>!0},Se=k({...be,appendToBody:Boolean,beforeClose:{type:O(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1}}),Ee={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[z]:e=>X(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},Me=(e,o)=>{const t=ne().emit,{nextZIndex:c}=R();let a="";const n=P(),d=P(),s=v(!1),f=v(!1),r=v(!1),p=v(e.zIndex||c());let y,m;const N=ee("namespace",le),A=M(()=>{const l={},i=`--${N.value}-dialog`;return e.fullscreen||(e.top&&(l[`${i}-margin-top`]=e.top),e.width&&(l[`${i}-width`]=de(e.width))),l}),L=M(()=>e.alignCenter?{display:"flex"}:{});function V(){t("opened")}function $(){t("closed"),t(z,!1),e.destroyOnClose&&(r.value=!1)}function H(){t("close")}function w(){m==null||m(),y==null||y(),e.openDelay&&e.openDelay>0?{stop:y}=T(()=>S(),e.openDelay):S()}function C(){y==null||y(),m==null||m(),e.closeDelay&&e.closeDelay>0?{stop:m}=T(()=>g(),e.closeDelay):g()}function b(){function l(i){i||(f.value=!0,s.value=!1)}e.beforeClose?e.beforeClose(l):C()}function Y(){e.closeOnClickModal&&b()}function S(){F&&(s.value=!0)}function g(){s.value=!1}function U(){t("openAutoFocus")}function W(){t("closeAutoFocus")}function _(l){var i;((i=l.detail)==null?void 0:i.focusReason)==="pointer"&&l.preventDefault()}e.lockScroll&&fe(s);function j(){e.closeOnPressEscape&&b()}return B(()=>e.modelValue,l=>{l?(f.value=!1,w(),r.value=!0,p.value=e.zIndex?p.value++:c(),oe(()=>{t("open"),o.value&&(o.value.scrollTop=0)})):s.value&&C()}),B(()=>e.fullscreen,l=>{o.value&&(l?(a=o.value.style.transform,o.value.style.transform=""):o.value.style.transform=a)}),te(()=>{e.modelValue&&(s.value=!0,r.value=!0,w())}),{afterEnter:V,afterLeave:$,beforeLeave:H,handleClose:b,onModalClick:Y,close:C,doClose:g,onOpenAutoFocus:U,onCloseAutoFocus:W,onCloseRequested:j,onFocusoutPrevented:_,titleId:n,bodyId:d,closed:f,style:A,overlayDialogStyle:L,rendered:r,visible:s,zIndex:p}};export{ke as E,Ee as a,be as b,we as c,Se as d,ye as e,Me as u};
