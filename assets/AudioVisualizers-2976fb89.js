import{d as A,g as s,s as L,o as V,c as B,a as v,w as f,j as b,b as E,F as S,v as U,_ as z}from"./index-9911e23c.js";import{E as F}from"./el-progress-88dc8242.js";import{E as H}from"./el-button-34644661.js";import"./use-form-item-e792babe.js";import"./typescript-defaf979.js";import"./_baseClone-e3d62307.js";import"./_Uint8Array-e9c6ac82.js";import"./_initCloneObject-8af3a743.js";import"./isEqual-f9d830fd.js";import"./index-c2641986.js";const p=350,_=350,I=A({__name:"AudioVisualizers",setup(P){const m=s(),n=s(),a=L(()=>m.value.getContext("2d")),u=s(),c=s(!1),t=s(),y=s();let i,d;function h(){const e=new AudioContext,l=e.createMediaElementSource(n.value);t.value=e.createAnalyser(),l.connect(t.value),t.value.connect(e.destination),t.value.fftSize=2048,i=t.value.frequencyBinCount,d=new Uint8Array(i),n.value.addEventListener("pause",()=>{c.value=!1}),n.value.addEventListener("play",()=>{c.value=!0,x()}),g()}function g(e){t.value||h(),n.value.src=e?URL.createObjectURL(e.raw):new URL("/src/assets/music/ParadiseLost.mp3",self.location),y.value=Math.random()*360,n.value.load(),U(()=>n.value.play())}function w(e){u.value.clearFiles();const l=e[0];u.value.handleStart(l)}function x(){c.value&&(a.value.clearRect(0,0,p,_),t.value.getByteFrequencyData(d),C(i,d),requestAnimationFrame(x))}function C(e,l){for(let o=0;o<e;o++){const r=l[o]*1.5;a.value.save(),a.value.translate(p/2,_/2),a.value.rotate(o*4.184);const k=y.value+o*.05;a.value.fillStyle=`hsl(${k},100%,50%)`,a.value.beginPath(),a.value.arc(0,r/4,r/4,0,Math.PI/4),a.value.fill(),a.value.stroke(),a.value.restore()}}return(e,l)=>{const o=H,r=F;return V(),B(S,null,[v(o,{type:"danger",disabled:typeof t.value=="object",onClick:h},{default:f(()=>[b(" 帕拉戴斯罗斯特 ")]),_:1},8,["disabled"]),E("canvas",{ref_key:"canvas",ref:m,width:p,height:_},null,512),E("audio",{ref_key:"audio1",ref:n,controls:""},null,512),v(r,{ref_key:"upload",ref:u,limit:1,"on-exceed":w,"on-change":g,"show-file-list":!1,"auto-upload":!1},{trigger:f(()=>[v(o,{type:"primary"},{default:f(()=>[b(" 选择本地音乐 ")]),_:1})]),_:1},512)],64)}}});const $=z(I,[["__scopeId","data-v-d383dc0c"]]);export{$ as default};
