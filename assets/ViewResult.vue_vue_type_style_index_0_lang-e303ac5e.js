import{c as z,i as F,E as I}from"./base-d162ef96.js";import{E as L}from"./el-scrollbar-528d0670.js";import{E as N,a as S}from"./el-table-column-c6742379.js";import"./el-checkbox-7957f217.js";import"./el-tooltip-4ed993c7.js";import{E as D}from"./el-popper-4c0fcaf7.js";import"./el-tag-51a09018.js";import{e as R,f as C,g as t,h as l,j as a,T as b,W as k,k as m,v as c,p as i,s as y,m as H,t as w,y as M}from"./index-e1e4d07d.js";import{l as W}from"./lodash-f3bfa25a.js";const A={class:"fc h-24 m-2 rounded-lg bg-white dark:bg-slate-800 relative"},G={key:0,class:"absolute w-full h-full bg-black/40 fc"},J=["src"],K=["src"],O={class:"fc flex-wrap w-44"},P=["src"],Q={class:"fc flex-wrap w-44"},U=["src"],X={class:"waterfall"},Y={class:"fc flex-col relative select-none"},Z={key:0,class:"absolute w-full h-full bg-black/40"},ee=["src"],te={class:"fc"},se={key:0,class:"absolute w-full h-full bg-black/80 z-10"},le=["onClick"],ae={key:0,class:"absolute w-full h-full bg-black/40 fc"},ne={class:"fc flex-col select-none"},oe=["src"],ge=R({__name:"ViewResult",props:["selectedBullet"],emits:["change","update:selectedBullet"],setup(B,{emit:j}){const V=B,E=C({get:()=>V.selectedBullet,set:e=>{j("update:selectedBullet",e)}}),$=C(()=>{const e=[];return E.value.forEach(_=>{var r;if((r=_.at(-1))!=null&&r.total){const d=_.at(-1).total;d==null||d.forEach(n=>{const f=e.find(h=>h.item_id===n.item_id);f?f.number+=n.number:e.push(W.cloneDeep(n))})}}),e}),T=C(()=>document.documentElement.offsetHeight-162);function q(e,_,r,d){if(r.kind!=="54"&&(r.done=!r.done),!_.article.find(n=>!n.done)){_.done=!0,d<e.length-1&&e.splice(d,1);let n=d;for(;n<e.length;){const f=e[n].article.find(h=>h.item_id===_.seq_id&&h.number===_.number);if(f){f.done=!0;break}n++}}}function p(e){if(!e)return"https://prd-game-a1-granbluefantasy.akamaized.net/assets/img/sp/job/bullet/empty.png";if(e.article)return`https://prd-game-a-granbluefantasy.akamaized.net/assets/img/sp/assets/bullet/s/${e.seq_id}.jpg`;if(e.kind==="10")return`https://prd-game-a-granbluefantasy.akamaized.net/assets/img/sp/assets/item/article/s/${e.item_id}.jpg`;if(e.kind==="17")return`https://prd-game-a-granbluefantasy.akamaized.net/assets/img/sp/assets/item/evolution/s/${e.item_id}.jpg`;if(e.kind==="54")return`https://prd-game-a-granbluefantasy.akamaized.net/assets/img/sp/assets/bullet/s/${e.item_id}.jpg`}return(e,_)=>{const r=I,d=D,n=N,f=S,h=L;return t(),l("div",null,[a("div",A,[(t(!0),l(b,null,k(m(E),(s,g)=>{var o;return t(),l("div",{key:g,class:"fc relative"},[s.at(-1)&&((o=s.at(-1))!=null&&o.done)?(t(),l("div",G,[c(r,{size:45,color:"#409EFC"},{default:i(()=>[c(m(z))]),_:1})])):y("",!0),s.length===0?(t(),l("img",{key:1,class:"w-14 h-14 m-2",src:p(s.at(-1))},null,8,J)):(t(),H(d,{key:2,effect:"dark",placement:"bottom"},{content:i(()=>{var v;return[a("div",O,[(t(!0),l(b,null,k((v=s.at(-1))==null?void 0:v.total,(u,x)=>(t(),l("div",{key:x,class:"fc flex-col select-none"},[a("img",{class:"w-12 h-12 m-1",src:p(u)},null,8,P),a("span",null,w(u.number),1)]))),128))])]}),default:i(()=>[a("img",{class:"w-14 h-14 m-2",src:p(s.at(-1))},null,8,K)]),_:2},1024))])}),128)),c(d,{effect:"dark",placement:"bottom"},{content:i(()=>[a("div",Q,[(t(!0),l(b,null,k(m($),(s,g)=>(t(),l("div",{key:g,class:"fc flex-col select-none"},[a("img",{class:"w-12 h-12 m-1",src:p(s)},null,8,U),a("span",null,w(s.number),1)]))),128))])]),default:i(()=>[c(r,{"mt-9":"","ml-2":""},{default:i(()=>[c(m(F))]),_:1})]),_:1})]),c(h,{"max-height":m(T)},{default:i(()=>[a("div",X,[(t(!0),l(b,null,k(m(E).filter(s=>s.length!==0&&s[s.length-1].done!==!0),(s,g)=>(t(),l("div",{key:g,class:"water p-2 m-auto"},[c(f,{data:s},{default:i(()=>[c(n,{prop:"seq_id",label:"目标",width:"80",align:"center"},{default:i(({row:o})=>[a("div",Y,[o.done?(t(),l("div",Z)):y("",!0),a("img",{class:"w-12 h-12 m-1",src:p(o)},null,8,ee),a("span",null,w(o.number?o.number:"1"),1)])]),_:1}),c(n,{prop:"article",label:"材料",width:"260",align:"center"},{default:i(({row:o,$index:v})=>[a("div",te,[o.article.find(u=>u.kind==="54"&&u.done!==!0)?(t(),l("div",se)):y("",!0),(t(!0),l(b,null,k(o.article,(u,x)=>(t(),l("div",{key:x,class:"relative cursor-pointer",onClick:M(ce=>q(s,o,u,v),["prevent"])},[u.done?(t(),l("div",ae,[c(r,{size:45,color:"#409EFC"},{default:i(()=>[c(m(z))]),_:1})])):y("",!0),a("div",ne,[a("img",{class:"w-12 h-12 m-1",src:p(u)},null,8,oe),a("span",null,w(u.number),1)])],8,le))),128))])]),_:2},1024)]),_:2},1032,["data"])]))),128))])]),_:1},8,["max-height"])])}}});export{ge as _};
