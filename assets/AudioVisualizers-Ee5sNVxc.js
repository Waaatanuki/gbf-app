import{d as A,g as r,s as L,o as B,c as V,a as v,w as f,j as b,b as E,F as S,v as U,_ as F}from"./index-bRI_KvZ7.js";import{E as H}from"./el-progress-5k1-TgcB.js";import{E as I}from"./el-button-duQ8d1Up.js";import"./use-form-item-9xKR0aF7.js";import"./typescript-WBLZcIum.js";import"./_baseClone-T1-aYGzW.js";import"./_Uint8Array-mEksOadB.js";import"./_initCloneObject-MtnTSx32.js";import"./isEqual-9CMk2mc5.js";import"./index-8mZRRmrB.js";const p=350,m=350,P=A({__name:"AudioVisualizers",setup(R){const _=r(),n=r(),a=L(()=>_.value.getContext("2d")),u=r(),c=r(!1),t=r(),h=r();let i,d;function y(){const e=new AudioContext,l=e.createMediaElementSource(n.value);t.value=e.createAnalyser(),l.connect(t.value),t.value.connect(e.destination),t.value.fftSize=2048,i=t.value.frequencyBinCount,d=new Uint8Array(i),n.value.addEventListener("pause",()=>{c.value=!1}),n.value.addEventListener("play",()=>{c.value=!0,x()}),g()}function g(e){t.value||y(),n.value.src=e?URL.createObjectURL(e.raw):new URL("/src/assets/music/ParadiseLost.mp3",import.meta.url),h.value=Math.random()*360,n.value.load(),U(()=>n.value.play())}function w(e){u.value.clearFiles();const l=e[0];u.value.handleStart(l)}function x(){c.value&&(a.value.clearRect(0,0,p,m),t.value.getByteFrequencyData(d),C(i,d),requestAnimationFrame(x))}function C(e,l){for(let o=0;o<e;o++){const s=l[o]*1.5;a.value.save(),a.value.translate(p/2,m/2),a.value.rotate(o*4.184);const k=h.value+o*.05;a.value.fillStyle=`hsl(${k},100%,50%)`,a.value.beginPath(),a.value.arc(0,s/4,s/4,0,Math.PI/4),a.value.fill(),a.value.stroke(),a.value.restore()}}return(e,l)=>{const o=I,s=H;return B(),V(S,null,[v(o,{type:"danger",disabled:typeof t.value=="object",onClick:y},{default:f(()=>[b(" 帕拉戴斯罗斯特 ")]),_:1},8,["disabled"]),E("canvas",{ref_key:"canvas",ref:_,width:p,height:m},null,512),E("audio",{ref_key:"audio1",ref:n,controls:""},null,512),v(s,{ref_key:"upload",ref:u,limit:1,"on-exceed":w,"on-change":g,"show-file-list":!1,"auto-upload":!1},{trigger:f(()=>[v(o,{type:"primary"},{default:f(()=>[b(" 选择本地音乐 ")]),_:1})]),_:1},512)],64)}}}),$=F(P,[["__scopeId","data-v-d383dc0c"]]);export{$ as default};
