import{d as A,i as r,f as L,o as B,c as V,a as f,w as v,h as b,b as E,F as S,x as U}from"./index-lohWmEMJ.js";import{E as F}from"./el-upload-zGKGnEzX.js";import"./el-progress-9ek7RHXv.js";import{E as H}from"./el-button-QiPo4arY.js";import{_ as I}from"./_plugin-vue_export-helper-x3n3nnut.js";import"./constants-AdI7_ttT.js";import"./typescript-WBLZcIum.js";import"./use-form-item-HLoKxQHv.js";import"./_baseClone-IqzBYuxY.js";import"./_Uint8Array-BDH910ps.js";import"./_initCloneObject-hcuKpeFQ.js";import"./isEqual-SS75QM1I.js";import"./index-qXTSIrvT.js";const p=350,m=350,P=A({__name:"AudioVisualizers",setup(R){const _=r(),n=r(),a=L(()=>_.value.getContext("2d")),u=r(),i=r(!1),t=r(),h=r();let c,d;function y(){const e=new AudioContext,l=e.createMediaElementSource(n.value);t.value=e.createAnalyser(),l.connect(t.value),t.value.connect(e.destination),t.value.fftSize=2048,c=t.value.frequencyBinCount,d=new Uint8Array(c),n.value.addEventListener("pause",()=>{i.value=!1}),n.value.addEventListener("play",()=>{i.value=!0,g()}),x()}function x(e){t.value||y(),n.value.src=e?URL.createObjectURL(e.raw):new URL("/src/assets/music/ParadiseLost.mp3",import.meta.url),h.value=Math.random()*360,n.value.load(),U(()=>n.value.play())}function w(e){u.value.clearFiles();const l=e[0];u.value.handleStart(l)}function g(){i.value&&(a.value.clearRect(0,0,p,m),t.value.getByteFrequencyData(d),C(c,d),requestAnimationFrame(g))}function C(e,l){for(let o=0;o<e;o++){const s=l[o]*1.5;a.value.save(),a.value.translate(p/2,m/2),a.value.rotate(o*4.184);const k=h.value+o*.05;a.value.fillStyle=`hsl(${k},100%,50%)`,a.value.beginPath(),a.value.arc(0,s/4,s/4,0,Math.PI/4),a.value.fill(),a.value.stroke(),a.value.restore()}}return(e,l)=>{const o=H,s=F;return B(),V(S,null,[f(o,{type:"danger",disabled:typeof t.value=="object",onClick:y},{default:v(()=>[b(" 帕拉戴斯罗斯特 ")]),_:1},8,["disabled"]),E("canvas",{ref_key:"canvas",ref:_,width:p,height:m},null,512),E("audio",{ref_key:"audio1",ref:n,controls:""},null,512),f(s,{ref_key:"upload",ref:u,limit:1,"on-exceed":w,"on-change":x,"show-file-list":!1,"auto-upload":!1},{trigger:v(()=>[f(o,{type:"primary"},{default:v(()=>[b(" 选择本地音乐 ")]),_:1})]),_:1},512)],64)}}}),Q=I(P,[["__scopeId","data-v-d383dc0c"]]);export{Q as default};
